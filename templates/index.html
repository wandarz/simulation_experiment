<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Planetary Simulation</title>
    <style>
        body { font-family: Arial, sans-serif; }
        #controls { margin-bottom: 20px; text-align: center; }
        .slider-label { display: flex; align-items: center; justify-content: center; margin: 10px 0; }
        .color-dot {
            display: inline-block;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .blue-dot { background: #1E90FF; }
        .yellow-dot { background: #FFD700; }
        .slider-value { width: 40px; display: inline-block; text-align: left; margin-left: 8px; }
        canvas { background: #000; display: block; margin: 0 auto; }
    </style>
</head>
<body>
    <div id="controls">
        <form id="massForm">
            <div class="slider-label">
                <span class="color-dot blue-dot"></span>
                <label for="massBlue">Blue Mass:</label>
                <input type="range" id="massBlue" min="1" max="1000" value="5">
                <span id="blueValue" class="slider-value">5</span>
            </div>
            <div class="slider-label">
                <span class="color-dot yellow-dot"></span>
                <label for="massYellow">Yellow Mass:</label>
                <input type="range" id="massYellow" min="1" max="1000" value="5">
                <span id="yellowValue" class="slider-value">5</span>
            </div>
            <div class="slider-label">
                <span class="color-dot blue-dot"></span>
                <label for="velBlue">Blue Initial Velocity:</label>
                <input type="range" id="velBlue" min="-5" max="5" value="1" step="0.01">
                <span id="blueVelValue" class="slider-value">1.00</span>
            </div>
            <div class="slider-label">
                <span class="color-dot yellow-dot"></span>
                <label for="velYellow">Yellow Initial Velocity:</label>
                <input type="range" id="velYellow" min="-5" max="5" value="-1" step="0.01">
                <span id="yellowVelValue" class="slider-value">-1.00</span>
            </div>
        </form>
    </div>
    <canvas id="simCanvas" width="600" height="400"></canvas>
    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const massBlueSlider = document.getElementById('massBlue');
        const massYellowSlider = document.getElementById('massYellow');
        const blueValue = document.getElementById('blueValue');
        const yellowValue = document.getElementById('yellowValue');
        const blueVelSlider = document.getElementById('velBlue');
        const yellowVelSlider = document.getElementById('velYellow');
        const blueVelValue = document.getElementById('blueVelValue');
        const yellowVelValue = document.getElementById('yellowVelValue');
        let massBlue = parseFloat(massBlueSlider.value);
        let massYellow = parseFloat(massYellowSlider.value);
        let velBlue = parseFloat(blueVelSlider.value);
        let velYellow = parseFloat(yellowVelSlider.value);

        // Trajectory data
        let simData = null;
        let frame = 0;
        let nFrames = 1;

        async function fetchSimulation() {
            massBlue = parseFloat(massBlueSlider.value);
            massYellow = parseFloat(massYellowSlider.value);
            velBlue = parseFloat(blueVelSlider.value);
            velYellow = parseFloat(yellowVelSlider.value);
            const response = await fetch('/simulate', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ masses: [massBlue, massYellow], velocities: [velBlue, velYellow] })
            });
            simData = await response.json();
            frame = 0;
            nFrames = simData.t.length;
        }

        // Attach fetchSimulation to all slider inputs
        massBlueSlider.oninput = () => {
            blueValue.textContent = massBlueSlider.value;
            fetchSimulation();
        };
        massYellowSlider.oninput = () => {
            yellowValue.textContent = massYellowSlider.value;
            fetchSimulation();
        };
        blueVelSlider.oninput = () => {
            blueVelValue.textContent = parseFloat(blueVelSlider.value).toFixed(2);
            fetchSimulation();
        };
        yellowVelSlider.oninput = () => {
            yellowVelValue.textContent = parseFloat(yellowVelSlider.value).toFixed(2);
            fetchSimulation();
        };

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            if (simData) {
                // Center the system in the canvas
                const cx = canvas.width / 2;
                const cy = canvas.height / 2;
                // Get positions for this frame
                const x1 = simData.x1[frame];
                const y1 = simData.y1[frame];
                const x2 = simData.x2[frame];
                const y2 = simData.y2[frame];
                // Calculate radii based on mass (sqrt for visibility, clamp between 10 and 40)
                let blueRadius = Math.max(10, Math.min(40, Math.sqrt(massBlue) * 2));
                let yellowRadius = Math.max(10, Math.min(40, Math.sqrt(massYellow) * 2));
                // Draw Blue planet
                ctx.beginPath();
                ctx.arc(cx + x1, cy + y1, blueRadius, 0, 2 * Math.PI);
                ctx.fillStyle = '#1E90FF';
                ctx.fill();
                // Draw Yellow planet
                ctx.beginPath();
                ctx.arc(cx + x2, cy + y2, yellowRadius, 0, 2 * Math.PI);
                ctx.fillStyle = '#FFD700';
                ctx.fill();
                // Optionally: draw velocity vectors
                /*
                ctx.beginPath();
                ctx.moveTo(cx + x1, cy + y1);
                ctx.lineTo(cx + x1 + simData.vx1[frame]*5, cy + y1 + simData.vy1[frame]*5);
                ctx.strokeStyle = '#1E90FF';
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(cx + x2, cy + y2);
                ctx.lineTo(cx + x2 + simData.vx2[frame]*5, cy + y2 + simData.vy2[frame]*5);
                ctx.strokeStyle = '#FFD700';
                ctx.stroke();
                */
                // Advance frame
                frame = (frame + 1) % nFrames;
            }
            requestAnimationFrame(draw);
        }

        // Initial fetch and start animation
        fetchSimulation();
        draw();
    </script>
</body>
</html> 